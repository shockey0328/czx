<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœç´¢æ•°æ®çœ‹æ¿ - è¯Šæ–­å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #FF6B35;
            margin-bottom: 20px;
        }
        .section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #FF6B35;
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-item.pending {
            background: #f0f0f0;
        }
        .test-item.success {
            background: #d4edda;
            color: #155724;
        }
        .test-item.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status {
            font-weight: bold;
            min-width: 60px;
        }
        button {
            background: #FF6B35;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }
        button:hover {
            background: #E85A2A;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .data-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .summary {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin-top: 20px;
        }
        .summary.error {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æœç´¢æ•°æ®çœ‹æ¿ - è¯Šæ–­å·¥å…·</h1>
        
        <div class="section">
            <h2>1. æ–‡ä»¶æ£€æµ‹</h2>
            <button onclick="testFiles()">å¼€å§‹æ£€æµ‹</button>
            <div id="fileTests"></div>
        </div>

        <div class="section">
            <h2>2. æ•°æ®åŠ è½½æµ‹è¯•</h2>
            <button onclick="testDataLoading()">æµ‹è¯•æ•°æ®åŠ è½½</button>
            <div id="dataTests"></div>
        </div>

        <div class="section">
            <h2>3. æ•°æ®é¢„è§ˆ</h2>
            <div id="dataPreview"></div>
        </div>

        <div class="section">
            <h2>4. è¯Šæ–­æ€»ç»“</h2>
            <div id="summary"></div>
        </div>
    </div>

    <script>
        const files = [
            'ç¬¬1å‘¨æœç´¢è¯.csv',
            'ç¬¬2å‘¨æœç´¢è¯.csv',
            'ç¬¬3å‘¨æœç´¢è¯.csv',
            'ç¬¬4å‘¨æœç´¢è¯.csv',
            'ç¬¬5å‘¨æœç´¢è¯.csv',
            'ç¬¬6å‘¨æœç´¢è¯.csv',
            'ç¬¬7å‘¨æœç´¢è¯.csv',
            'ç¬¬8å‘¨æœç´¢è¯.csv',
            'æœç´¢è¡Œä¸ºæ¼æ–—.csv',
            'æœç´¢è½¬åŒ–ç‡.csv',
            'æœç´¢åŠŸèƒ½ç•™å­˜çœ‹æ¿.csv'
        ];

        let testResults = {
            filesExist: 0,
            filesTotal: files.length,
            dataLoaded: 0,
            dataTotal: files.length,
            errors: []
        };

        async function testFiles() {
            const container = document.getElementById('fileTests');
            container.innerHTML = '<p>æ­£åœ¨æ£€æµ‹æ–‡ä»¶...</p>';
            
            let html = '';
            testResults.filesExist = 0;
            testResults.errors = [];

            for (const file of files) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    if (response.ok) {
                        html += `<div class="test-item success"><span class="status">âœ“ å­˜åœ¨</span>${file}</div>`;
                        testResults.filesExist++;
                    } else {
                        html += `<div class="test-item error"><span class="status">âœ— ç¼ºå¤±</span>${file} (HTTP ${response.status})</div>`;
                        testResults.errors.push(`${file}: HTTP ${response.status}`);
                    }
                } catch (error) {
                    html += `<div class="test-item error"><span class="status">âœ— é”™è¯¯</span>${file} (${error.message})</div>`;
                    testResults.errors.push(`${file}: ${error.message}`);
                }
            }

            container.innerHTML = html;
            updateSummary();
        }

        async function testDataLoading() {
            const container = document.getElementById('dataTests');
            const previewContainer = document.getElementById('dataPreview');
            container.innerHTML = '<p>æ­£åœ¨æµ‹è¯•æ•°æ®åŠ è½½...</p>';
            
            let html = '';
            let previewHtml = '';
            testResults.dataLoaded = 0;

            // æµ‹è¯•ç¬¬1å‘¨æœç´¢è¯
            try {
                const response = await fetch('ç¬¬1å‘¨æœç´¢è¯.csv');
                const text = await response.text();
                const lines = text.trim().split('\n');
                
                if (lines.length > 1) {
                    html += `<div class="test-item success"><span class="status">âœ“ æˆåŠŸ</span>ç¬¬1å‘¨æœç´¢è¯ (${lines.length - 1} æ¡æ•°æ®)</div>`;
                    testResults.dataLoaded++;
                    
                    previewHtml += '<h3>ç¬¬1å‘¨æœç´¢è¯ - å‰5è¡Œé¢„è§ˆï¼š</h3>';
                    previewHtml += '<div class="data-preview">';
                    previewHtml += lines.slice(0, 6).map(line => line.replace(/</g, '&lt;').replace(/>/g, '&gt;')).join('\n');
                    previewHtml += '</div>';
                } else {
                    html += `<div class="test-item error"><span class="status">âœ— ç©ºæ–‡ä»¶</span>ç¬¬1å‘¨æœç´¢è¯</div>`;
                }
            } catch (error) {
                html += `<div class="test-item error"><span class="status">âœ— å¤±è´¥</span>ç¬¬1å‘¨æœç´¢è¯: ${error.message}</div>`;
            }

            // æµ‹è¯•æ¼æ–—æ•°æ®
            try {
                const response = await fetch('æœç´¢è¡Œä¸ºæ¼æ–—.csv');
                const text = await response.text();
                const lines = text.trim().split('\n');
                
                if (lines.length > 1) {
                    html += `<div class="test-item success"><span class="status">âœ“ æˆåŠŸ</span>æœç´¢è¡Œä¸ºæ¼æ–— (${lines.length - 1} æ¡æ•°æ®)</div>`;
                    testResults.dataLoaded++;
                    
                    previewHtml += '<h3>æœç´¢è¡Œä¸ºæ¼æ–— - å‰5è¡Œé¢„è§ˆï¼š</h3>';
                    previewHtml += '<div class="data-preview">';
                    previewHtml += lines.slice(0, 6).map(line => line.replace(/</g, '&lt;').replace(/>/g, '&gt;')).join('\n');
                    previewHtml += '</div>';
                } else {
                    html += `<div class="test-item error"><span class="status">âœ— ç©ºæ–‡ä»¶</span>æœç´¢è¡Œä¸ºæ¼æ–—</div>`;
                }
            } catch (error) {
                html += `<div class="test-item error"><span class="status">âœ— å¤±è´¥</span>æœç´¢è¡Œä¸ºæ¼æ–—: ${error.message}</div>`;
            }

            // æµ‹è¯•è½¬åŒ–ç‡æ•°æ®
            try {
                const response = await fetch('æœç´¢è½¬åŒ–ç‡.csv');
                const text = await response.text();
                const lines = text.trim().split('\n');
                
                if (lines.length > 1) {
                    html += `<div class="test-item success"><span class="status">âœ“ æˆåŠŸ</span>æœç´¢è½¬åŒ–ç‡ (${lines.length - 1} æ¡æ•°æ®)</div>`;
                    testResults.dataLoaded++;
                    
                    previewHtml += '<h3>æœç´¢è½¬åŒ–ç‡ - å‰5è¡Œé¢„è§ˆï¼š</h3>';
                    previewHtml += '<div class="data-preview">';
                    previewHtml += lines.slice(0, 6).map(line => line.replace(/</g, '&lt;').replace(/>/g, '&gt;')).join('\n');
                    previewHtml += '</div>';
                } else {
                    html += `<div class="test-item error"><span class="status">âœ— ç©ºæ–‡ä»¶</span>æœç´¢è½¬åŒ–ç‡</div>`;
                }
            } catch (error) {
                html += `<div class="test-item error"><span class="status">âœ— å¤±è´¥</span>æœç´¢è½¬åŒ–ç‡: ${error.message}</div>`;
            }

            // æµ‹è¯•ç•™å­˜æ•°æ®
            try {
                const response = await fetch('æœç´¢åŠŸèƒ½ç•™å­˜çœ‹æ¿.csv');
                const text = await response.text();
                const lines = text.trim().split('\n');
                
                if (lines.length > 1) {
                    html += `<div class="test-item success"><span class="status">âœ“ æˆåŠŸ</span>æœç´¢åŠŸèƒ½ç•™å­˜ (${lines.length - 1} æ¡æ•°æ®)</div>`;
                    testResults.dataLoaded++;
                    
                    previewHtml += '<h3>æœç´¢åŠŸèƒ½ç•™å­˜ - å‰5è¡Œé¢„è§ˆï¼š</h3>';
                    previewHtml += '<div class="data-preview">';
                    previewHtml += lines.slice(0, 6).map(line => line.replace(/</g, '&lt;').replace(/>/g, '&gt;')).join('\n');
                    previewHtml += '</div>';
                } else {
                    html += `<div class="test-item error"><span class="status">âœ— ç©ºæ–‡ä»¶</span>æœç´¢åŠŸèƒ½ç•™å­˜</div>`;
                }
            } catch (error) {
                html += `<div class="test-item error"><span class="status">âœ— å¤±è´¥</span>æœç´¢åŠŸèƒ½ç•™å­˜: ${error.message}</div>`;
            }

            container.innerHTML = html;
            previewContainer.innerHTML = previewHtml;
            updateSummary();
        }

        function updateSummary() {
            const container = document.getElementById('summary');
            const allSuccess = testResults.filesExist === testResults.filesTotal && 
                              testResults.dataLoaded === testResults.dataTotal;
            
            let html = '';
            
            if (allSuccess) {
                html = `
                    <div class="summary">
                        <h3>âœ“ è¯Šæ–­é€šè¿‡</h3>
                        <p>æ‰€æœ‰æ–‡ä»¶éƒ½å­˜åœ¨ä¸”å¯ä»¥æ­£å¸¸åŠ è½½ã€‚</p>
                        <p><strong>æ–‡ä»¶æ£€æµ‹ï¼š</strong>${testResults.filesExist}/${testResults.filesTotal} é€šè¿‡</p>
                        <p><strong>æ•°æ®åŠ è½½ï¼š</strong>${testResults.dataLoaded}/${testResults.dataTotal} æˆåŠŸ</p>
                        <p style="margin-top: 15px;">âœ… æœç´¢æ•°æ®çœ‹æ¿åº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤ºçœŸå®æ•°æ®ã€‚</p>
                    </div>
                `;
            } else {
                html = `
                    <div class="summary error">
                        <h3>âš ï¸ å‘ç°é—®é¢˜</h3>
                        <p><strong>æ–‡ä»¶æ£€æµ‹ï¼š</strong>${testResults.filesExist}/${testResults.filesTotal} é€šè¿‡</p>
                        <p><strong>æ•°æ®åŠ è½½ï¼š</strong>${testResults.dataLoaded}/${testResults.dataTotal} æˆåŠŸ</p>
                `;
                
                if (testResults.errors.length > 0) {
                    html += '<p style="margin-top: 10px;"><strong>é”™è¯¯åˆ—è¡¨ï¼š</strong></p><ul>';
                    testResults.errors.forEach(error => {
                        html += `<li>${error}</li>`;
                    });
                    html += '</ul>';
                }
                
                html += `
                        <p style="margin-top: 15px;"><strong>å»ºè®®ï¼š</strong></p>
                        <ul>
                            <li>ç¡®ä¿é€šè¿‡ HTTP æœåŠ¡å™¨è®¿é—®ï¼ˆä¸è¦ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶ï¼‰</li>
                            <li>æ£€æŸ¥ CSV æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºæ­£ç¡®çš„ç›®å½•</li>
                            <li>ç¡®è®¤æ–‡ä»¶ç¼–ç ä¸º UTF-8</li>
                            <li>æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯</li>
                        </ul>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºå½“å‰è·¯å¾„
        window.addEventListener('load', () => {
            console.log('å½“å‰é¡µé¢è·¯å¾„:', window.location.href);
            console.log('å½“å‰ç›®å½•:', window.location.pathname);
        });
    </script>
</body>
</html>
