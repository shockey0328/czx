{"ast":null,"code":"import axios from 'axios';\n\n// 测试DeepSeek API连接\nexport const testDeepSeekAPI = async apiKey => {\n  var _data$error;\n  try {\n    console.log('🧪 测试DeepSeek API连接...');\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\n      model: 'deepseek-chat',\n      messages: [{\n        role: 'user',\n        content: '请简单回复\"API连接成功\"'\n      }],\n      temperature: 0.1,\n      max_tokens: 50\n    }, {\n      headers: {\n        'Authorization': `Bearer ${apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      timeout: 10000 // 10秒超时\n    });\n    console.log('✅ API测试成功:', response.data);\n    return {\n      success: true,\n      message: 'API连接成功',\n      response: response.data.choices[0].message.content\n    };\n  } catch (error) {\n    console.error('❌ API测试失败:', error);\n    let errorMessage = 'API连接失败';\n    if (error.response) {\n      // 服务器返回错误\n      const status = error.response.status;\n      const data = error.response.data;\n      switch (status) {\n        case 401:\n          errorMessage = 'API密钥无效或已过期';\n          break;\n        case 403:\n          errorMessage = 'API密钥权限不足';\n          break;\n        case 429:\n          errorMessage = 'API调用频率超限，请稍后重试';\n          break;\n        case 500:\n          errorMessage = 'DeepSeek服务器内部错误';\n          break;\n        default:\n          errorMessage = `API错误 (${status}): ${(data === null || data === void 0 ? void 0 : (_data$error = data.error) === null || _data$error === void 0 ? void 0 : _data$error.message) || '未知错误'}`;\n      }\n    } else if (error.request) {\n      // 网络错误\n      errorMessage = '网络连接失败，请检查网络设置';\n    } else {\n      // 其他错误\n      errorMessage = error.message || '未知错误';\n    }\n    return {\n      success: false,\n      message: errorMessage,\n      error: error\n    };\n  }\n};\n\n// 测试数据分析功能\nexport const testDataAnalysis = async (apiKey, sampleData) => {\n  try {\n    console.log('🧪 测试数据分析功能...');\n    const prompt = `\n请分析以下数据并返回JSON格式：\n月活用户：${sampleData.月活}\n营收：${sampleData.营收}\n留存率：${sampleData.次月留存}%\n\n请严格按照以下JSON格式返回：\n{\n  \"keyChanges\": \"关键变化描述\",\n  \"trends\": \"趋势分析\", \n  \"suggestions\": [\"建议1\", \"建议2\", \"建议3\"]\n}\n`;\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\n      model: 'deepseek-chat',\n      messages: [{\n        role: 'user',\n        content: prompt\n      }],\n      temperature: 0.7,\n      max_tokens: 300\n    }, {\n      headers: {\n        'Authorization': `Bearer ${apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      timeout: 15000\n    });\n    const aiResponse = response.data.choices[0].message.content;\n    console.log('🤖 AI原始响应:', aiResponse);\n\n    // 尝试解析JSON\n    try {\n      const parsedResponse = JSON.parse(aiResponse);\n      console.log('✅ JSON解析成功:', parsedResponse);\n      return {\n        success: true,\n        message: '数据分析功能正常',\n        data: parsedResponse\n      };\n    } catch (parseError) {\n      console.warn('⚠️ JSON解析失败，但API调用成功');\n      return {\n        success: true,\n        message: 'API调用成功，但响应格式需要调整',\n        rawResponse: aiResponse,\n        parseError: parseError.message\n      };\n    }\n  } catch (error) {\n    console.error('❌ 数据分析测试失败:', error);\n    return {\n      success: false,\n      message: '数据分析功能测试失败',\n      error: error\n    };\n  }\n};","map":{"version":3,"names":["axios","testDeepSeekAPI","apiKey","_data$error","console","log","response","post","model","messages","role","content","temperature","max_tokens","headers","timeout","data","success","message","choices","error","errorMessage","status","request","testDataAnalysis","sampleData","prompt","月活","营收","次月留存","aiResponse","parsedResponse","JSON","parse","parseError","warn","rawResponse"],"sources":["E:/橙子学数据看板/月数据看板/src/utils/testAPI.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// 测试DeepSeek API连接\r\nexport const testDeepSeekAPI = async (apiKey) => {\r\n  try {\r\n    console.log('🧪 测试DeepSeek API连接...');\r\n    \r\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\r\n      model: 'deepseek-chat',\r\n      messages: [\r\n        {\r\n          role: 'user',\r\n          content: '请简单回复\"API连接成功\"'\r\n        }\r\n      ],\r\n      temperature: 0.1,\r\n      max_tokens: 50\r\n    }, {\r\n      headers: {\r\n        'Authorization': `Bearer ${apiKey}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      timeout: 10000 // 10秒超时\r\n    });\r\n\r\n    console.log('✅ API测试成功:', response.data);\r\n    return {\r\n      success: true,\r\n      message: 'API连接成功',\r\n      response: response.data.choices[0].message.content\r\n    };\r\n  } catch (error) {\r\n    console.error('❌ API测试失败:', error);\r\n    \r\n    let errorMessage = 'API连接失败';\r\n    \r\n    if (error.response) {\r\n      // 服务器返回错误\r\n      const status = error.response.status;\r\n      const data = error.response.data;\r\n      \r\n      switch (status) {\r\n        case 401:\r\n          errorMessage = 'API密钥无效或已过期';\r\n          break;\r\n        case 403:\r\n          errorMessage = 'API密钥权限不足';\r\n          break;\r\n        case 429:\r\n          errorMessage = 'API调用频率超限，请稍后重试';\r\n          break;\r\n        case 500:\r\n          errorMessage = 'DeepSeek服务器内部错误';\r\n          break;\r\n        default:\r\n          errorMessage = `API错误 (${status}): ${data?.error?.message || '未知错误'}`;\r\n      }\r\n    } else if (error.request) {\r\n      // 网络错误\r\n      errorMessage = '网络连接失败，请检查网络设置';\r\n    } else {\r\n      // 其他错误\r\n      errorMessage = error.message || '未知错误';\r\n    }\r\n    \r\n    return {\r\n      success: false,\r\n      message: errorMessage,\r\n      error: error\r\n    };\r\n  }\r\n};\r\n\r\n// 测试数据分析功能\r\nexport const testDataAnalysis = async (apiKey, sampleData) => {\r\n  try {\r\n    console.log('🧪 测试数据分析功能...');\r\n    \r\n    const prompt = `\r\n请分析以下数据并返回JSON格式：\r\n月活用户：${sampleData.月活}\r\n营收：${sampleData.营收}\r\n留存率：${sampleData.次月留存}%\r\n\r\n请严格按照以下JSON格式返回：\r\n{\r\n  \"keyChanges\": \"关键变化描述\",\r\n  \"trends\": \"趋势分析\", \r\n  \"suggestions\": [\"建议1\", \"建议2\", \"建议3\"]\r\n}\r\n`;\r\n\r\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\r\n      model: 'deepseek-chat',\r\n      messages: [\r\n        {\r\n          role: 'user',\r\n          content: prompt\r\n        }\r\n      ],\r\n      temperature: 0.7,\r\n      max_tokens: 300\r\n    }, {\r\n      headers: {\r\n        'Authorization': `Bearer ${apiKey}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      timeout: 15000\r\n    });\r\n\r\n    const aiResponse = response.data.choices[0].message.content;\r\n    console.log('🤖 AI原始响应:', aiResponse);\r\n    \r\n    // 尝试解析JSON\r\n    try {\r\n      const parsedResponse = JSON.parse(aiResponse);\r\n      console.log('✅ JSON解析成功:', parsedResponse);\r\n      \r\n      return {\r\n        success: true,\r\n        message: '数据分析功能正常',\r\n        data: parsedResponse\r\n      };\r\n    } catch (parseError) {\r\n      console.warn('⚠️ JSON解析失败，但API调用成功');\r\n      return {\r\n        success: true,\r\n        message: 'API调用成功，但响应格式需要调整',\r\n        rawResponse: aiResponse,\r\n        parseError: parseError.message\r\n      };\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('❌ 数据分析测试失败:', error);\r\n    return {\r\n      success: false,\r\n      message: '数据分析功能测试失败',\r\n      error: error\r\n    };\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}