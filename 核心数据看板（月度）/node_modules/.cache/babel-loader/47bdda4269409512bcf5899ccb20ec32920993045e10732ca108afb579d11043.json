{"ast":null,"code":"import React,{useState,useEffect}from'react';import Papa from'papaparse';import Header from'./components/Header';import MetricsCards from'./components/MetricsCards';import TrendCharts from'./components/TrendCharts';import AIAnalysis from'./components/AIAnalysis';import BMetrics from'./components/BMetrics';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[monthlyData,setMonthlyData]=useState([]);const[bData,setBData]=useState([]);const[selectedMonth,setSelectedMonth]=useState('');const[availableMonths,setAvailableMonths]=useState([]);const[loading,setLoading]=useState(true);// 加载CSV数据\nuseEffect(()=>{const loadData=async()=>{try{// 加载月度核心数据\nconst monthlyResponse=await fetch('/月度核心数据.csv');const monthlyText=await monthlyResponse.text();const monthlyParsed=Papa.parse(monthlyText,{header:true});// 加载B端核心数据\nconst bResponse=await fetch('/B端核心数据.csv');const bText=await bResponse.text();const bParsed=Papa.parse(bText,{header:true});// 处理月度数据\nconst processedMonthlyData=monthlyParsed.data.filter(row=>row.年份&&row.月份).map(row=>({年份:parseInt(row.年份.replace('年','')),月份:parseInt(row.月份.replace('月','')),月活:parseInt(row.月活),次月留存:parseFloat(row.次月留存.replace('%','')),营收:parseInt(row.营收),订单:parseInt(row.订单),ARPU:parseFloat(row.ARPU),ARPPU:parseFloat(row.ARPPU),深度访问率:parseFloat(row.深度访问率.replace('%','')),使用率:parseFloat(row.使用率.replace('%','')),大会员活跃率:parseFloat(row.大会员活跃率.replace('%',''))}));// 处理B端数据\nconst processedBData=bParsed.data.filter(row=>row.年份&&row.月份).map(row=>({年份:parseInt(row.年份.replace('年','')),月份:parseInt(row.月份.replace('月','')),签约金额:parseFloat(row.签约金额.replace('万','')),开票金额:parseFloat(row.开票金额.replace('万','')),到款金额:parseFloat(row.到款金额.replace('万','')),订单数:parseInt(row.订单数),新签:parseInt(row.新签),续签:parseInt(row.续签)}));setMonthlyData(processedMonthlyData);setBData(processedBData);// 生成可用月份列表\nconst months=processedMonthlyData.map(row=>({year:row.年份,month:row.月份,label:\"\".concat(row.年份+2000,\"\\u5E74\").concat(row.月份,\"\\u6708\")}));setAvailableMonths(months);// 设置默认选择最新月份\nif(months.length>0){const latest=months[months.length-1];setSelectedMonth(\"\".concat(latest.year,\"-\").concat(latest.month));}setLoading(false);}catch(error){console.error('数据加载失败:',error);setLoading(false);}};loadData();},[]);// 获取当前选中月份的数据\nconst getCurrentMonthData=()=>{if(!selectedMonth)return null;const[year,month]=selectedMonth.split('-').map(Number);return monthlyData.find(row=>row.年份===year&&row.月份===month);};const getCurrentBData=()=>{if(!selectedMonth)return null;const[year,month]=selectedMonth.split('-').map(Number);return bData.find(row=>row.年份===year&&row.月份===month);};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u6570\\u636E\\u52A0\\u8F7D\\u4E2D...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{selectedMonth:selectedMonth,setSelectedMonth:setSelectedMonth,availableMonths:availableMonths}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(MetricsCards,{currentData:getCurrentMonthData(),allData:monthlyData,selectedMonth:selectedMonth}),/*#__PURE__*/_jsx(TrendCharts,{data:monthlyData,selectedMonth:selectedMonth}),/*#__PURE__*/_jsx(AIAnalysis,{currentData:getCurrentMonthData(),allData:monthlyData,selectedMonth:selectedMonth}),/*#__PURE__*/_jsx(BMetrics,{currentData:getCurrentBData(),allData:bData,selectedMonth:selectedMonth})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Papa","Header","MetricsCards","TrendCharts","AIAnalysis","BMetrics","jsx","_jsx","jsxs","_jsxs","App","monthlyData","setMonthlyData","bData","setBData","selectedMonth","setSelectedMonth","availableMonths","setAvailableMonths","loading","setLoading","loadData","monthlyResponse","fetch","monthlyText","text","monthlyParsed","parse","header","bResponse","bText","bParsed","processedMonthlyData","data","filter","row","年份","月份","map","parseInt","replace","月活","次月留存","parseFloat","营收","订单","ARPU","ARPPU","深度访问率","使用率","大会员活跃率","processedBData","签约金额","开票金额","到款金额","订单数","新签","续签","months","year","month","label","concat","length","latest","error","console","getCurrentMonthData","split","Number","find","getCurrentBData","className","children","currentData","allData"],"sources":["E:/橙子学数据看板/月数据看板/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Papa from 'papaparse';\r\nimport Header from './components/Header';\r\nimport MetricsCards from './components/MetricsCards';\r\nimport TrendCharts from './components/TrendCharts';\r\nimport AIAnalysis from './components/AIAnalysis';\r\nimport BMetrics from './components/BMetrics';\r\nimport './App.css';\r\n\r\nfunction App() {\r\n  const [monthlyData, setMonthlyData] = useState([]);\r\n  const [bData, setBData] = useState([]);\r\n  const [selectedMonth, setSelectedMonth] = useState('');\r\n  const [availableMonths, setAvailableMonths] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // 加载CSV数据\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        // 加载月度核心数据\r\n        const monthlyResponse = await fetch('/月度核心数据.csv');\r\n        const monthlyText = await monthlyResponse.text();\r\n        const monthlyParsed = Papa.parse(monthlyText, { header: true });\r\n        \r\n        // 加载B端核心数据\r\n        const bResponse = await fetch('/B端核心数据.csv');\r\n        const bText = await bResponse.text();\r\n        const bParsed = Papa.parse(bText, { header: true });\r\n\r\n        // 处理月度数据\r\n        const processedMonthlyData = monthlyParsed.data\r\n          .filter(row => row.年份 && row.月份)\r\n          .map(row => ({\r\n            年份: parseInt(row.年份.replace('年', '')),\r\n            月份: parseInt(row.月份.replace('月', '')),\r\n            月活: parseInt(row.月活),\r\n            次月留存: parseFloat(row.次月留存.replace('%', '')),\r\n            营收: parseInt(row.营收),\r\n            订单: parseInt(row.订单),\r\n            ARPU: parseFloat(row.ARPU),\r\n            ARPPU: parseFloat(row.ARPPU),\r\n            深度访问率: parseFloat(row.深度访问率.replace('%', '')),\r\n            使用率: parseFloat(row.使用率.replace('%', '')),\r\n            大会员活跃率: parseFloat(row.大会员活跃率.replace('%', ''))\r\n          }));\r\n\r\n        // 处理B端数据\r\n        const processedBData = bParsed.data\r\n          .filter(row => row.年份 && row.月份)\r\n          .map(row => ({\r\n            年份: parseInt(row.年份.replace('年', '')),\r\n            月份: parseInt(row.月份.replace('月', '')),\r\n            签约金额: parseFloat(row.签约金额.replace('万', '')),\r\n            开票金额: parseFloat(row.开票金额.replace('万', '')),\r\n            到款金额: parseFloat(row.到款金额.replace('万', '')),\r\n            订单数: parseInt(row.订单数),\r\n            新签: parseInt(row.新签),\r\n            续签: parseInt(row.续签)\r\n          }));\r\n\r\n        setMonthlyData(processedMonthlyData);\r\n        setBData(processedBData);\r\n\r\n        // 生成可用月份列表\r\n        const months = processedMonthlyData.map(row => ({\r\n          year: row.年份,\r\n          month: row.月份,\r\n          label: `${row.年份 + 2000}年${row.月份}月`\r\n        }));\r\n        \r\n        setAvailableMonths(months);\r\n        \r\n        // 设置默认选择最新月份\r\n        if (months.length > 0) {\r\n          const latest = months[months.length - 1];\r\n          setSelectedMonth(`${latest.year}-${latest.month}`);\r\n        }\r\n\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error('数据加载失败:', error);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // 获取当前选中月份的数据\r\n  const getCurrentMonthData = () => {\r\n    if (!selectedMonth) return null;\r\n    const [year, month] = selectedMonth.split('-').map(Number);\r\n    return monthlyData.find(row => row.年份 === year && row.月份 === month);\r\n  };\r\n\r\n  const getCurrentBData = () => {\r\n    if (!selectedMonth) return null;\r\n    const [year, month] = selectedMonth.split('-').map(Number);\r\n    return bData.find(row => row.年份 === year && row.月份 === month);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"loading\">\r\n        <div className=\"loading-spinner\"></div>\r\n        <p>数据加载中...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Header \r\n        selectedMonth={selectedMonth}\r\n        setSelectedMonth={setSelectedMonth}\r\n        availableMonths={availableMonths}\r\n      />\r\n      \r\n      <div className=\"container\">\r\n        <MetricsCards \r\n          currentData={getCurrentMonthData()}\r\n          allData={monthlyData}\r\n          selectedMonth={selectedMonth}\r\n        />\r\n        \r\n        <TrendCharts \r\n          data={monthlyData}\r\n          selectedMonth={selectedMonth}\r\n        />\r\n        \r\n        <AIAnalysis \r\n          currentData={getCurrentMonthData()}\r\n          allData={monthlyData}\r\n          selectedMonth={selectedMonth}\r\n        />\r\n        \r\n        <BMetrics \r\n          currentData={getCurrentBData()}\r\n          allData={bData}\r\n          selectedMonth={selectedMonth}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}