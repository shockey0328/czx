{"ast":null,"code":"import React,{useState}from'react';import{LineChart,Line,XAxis,YAxis,CartesianGrid,Tooltip,ResponsiveContainer}from'recharts';import'./TrendCharts.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TrendCharts=_ref=>{let{data,selectedMonth}=_ref;const[timeRange,setTimeRange]=useState(6);// 默认6个月\nif(!data||data.length===0)return null;const[currentYear,currentMonth]=selectedMonth.split('-').map(Number);// 获取指定时间范围的数据\nconst getTimeRangeData=()=>{// 找到当前月份的索引\nconst currentIndex=data.findIndex(row=>row.年份===currentYear&&row.月份===currentMonth);if(currentIndex===-1)return[];// 获取前N个月的数据（包含当前月）\nconst startIndex=Math.max(0,currentIndex-timeRange+1);return data.slice(startIndex,currentIndex+1);};const chartData=getTimeRangeData().map(row=>({month:\"\".concat(row.年份+2000,\"\\u5E74\").concat(row.月份,\"\\u6708\"),活跃用户:row.月活,营收:row.营收,ARPU:row.ARPU,使用率:row.使用率}));// 自定义Tooltip\nconst CustomTooltip=_ref2=>{let{active,payload,label}=_ref2;if(active&&payload&&payload.length){return/*#__PURE__*/_jsxs(\"div\",{className:\"custom-tooltip\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"tooltip-label\",children:label}),payload.map((entry,index)=>/*#__PURE__*/_jsxs(\"p\",{style:{color:entry.color},children:[entry.dataKey,\": \",entry.dataKey==='活跃用户'||entry.dataKey==='营收'?entry.value.toLocaleString():entry.dataKey==='使用率'?\"\".concat(entry.value,\"%\"):entry.value.toFixed(2)]},index))]});}return null;};// 格式化Y轴数值\nconst formatYAxis=(value,type)=>{if(type==='user'||type==='revenue'){if(value>=10000){return\"\".concat((value/10000).toFixed(0),\"\\u4E07\");}return value.toLocaleString();}if(type==='usage'){return\"\".concat(value,\"%\");}return value;};const ChartCard=_ref3=>{let{title,dataKey,color,type}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-card\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"chart-title\",children:title}),/*#__PURE__*/_jsx(\"div\",{className:\"chart-container\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(LineChart,{data:chartData,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#f0f0f0\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"month\",tick:{fontSize:12},angle:-45,textAnchor:\"end\",height:60}),/*#__PURE__*/_jsx(YAxis,{tick:{fontSize:12},tickFormatter:value=>formatYAxis(value,type)}),/*#__PURE__*/_jsx(Tooltip,{content:/*#__PURE__*/_jsx(CustomTooltip,{})}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:dataKey,stroke:color,strokeWidth:3,dot:{fill:color,strokeWidth:2,r:4},activeDot:{r:6,stroke:color,strokeWidth:2}})]})})})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"trend-charts\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"charts-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u8D8B\\u52BF\\u5206\\u6790\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"time-range-selector\",children:[/*#__PURE__*/_jsx(\"button\",{className:timeRange===3?'active':'',onClick:()=>setTimeRange(3),children:\"\\u8FD13\\u4E2A\\u6708\"}),/*#__PURE__*/_jsx(\"button\",{className:timeRange===6?'active':'',onClick:()=>setTimeRange(6),children:\"\\u8FD16\\u4E2A\\u6708\"}),/*#__PURE__*/_jsx(\"button\",{className:timeRange===12?'active':'',onClick:()=>setTimeRange(12),children:\"\\u8FD112\\u4E2A\\u6708\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"charts-grid\",children:[/*#__PURE__*/_jsx(ChartCard,{title:\"\\u6D3B\\u8DC3\\u7528\\u6237\\u8D8B\\u52BF\",dataKey:\"\\u6D3B\\u8DC3\\u7528\\u6237\",color:\"#FF6B35\",type:\"user\"}),/*#__PURE__*/_jsx(ChartCard,{title:\"\\u8425\\u6536\\u8D8B\\u52BF\",dataKey:\"\\u8425\\u6536\",color:\"#FFA366\",type:\"revenue\"}),/*#__PURE__*/_jsx(ChartCard,{title:\"ARPU\\u8D8B\\u52BF\",dataKey:\"ARPU\",color:\"#FF8C42\",type:\"arpu\"}),/*#__PURE__*/_jsx(ChartCard,{title:\"\\u4F7F\\u7528\\u7387\\u8D8B\\u52BF\",dataKey:\"\\u4F7F\\u7528\\u7387\",color:\"#FFB366\",type:\"usage\"})]})]});};export default TrendCharts;","map":{"version":3,"names":["React","useState","LineChart","Line","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","jsx","_jsx","jsxs","_jsxs","TrendCharts","_ref","data","selectedMonth","timeRange","setTimeRange","length","currentYear","currentMonth","split","map","Number","getTimeRangeData","currentIndex","findIndex","row","年份","月份","startIndex","Math","max","slice","chartData","month","concat","活跃用户","月活","营收","ARPU","使用率","CustomTooltip","_ref2","active","payload","label","className","children","entry","index","style","color","dataKey","value","toLocaleString","toFixed","formatYAxis","type","ChartCard","_ref3","title","width","height","strokeDasharray","stroke","tick","fontSize","angle","textAnchor","tickFormatter","content","strokeWidth","dot","fill","r","activeDot","onClick"],"sources":["E:/橙子学数据看板/月数据看板/src/components/TrendCharts.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\r\nimport './TrendCharts.css';\r\n\r\nconst TrendCharts = ({ data, selectedMonth }) => {\r\n  const [timeRange, setTimeRange] = useState(6); // 默认6个月\r\n\r\n  if (!data || data.length === 0) return null;\r\n\r\n  const [currentYear, currentMonth] = selectedMonth.split('-').map(Number);\r\n\r\n  // 获取指定时间范围的数据\r\n  const getTimeRangeData = () => {\r\n    // 找到当前月份的索引\r\n    const currentIndex = data.findIndex(row => row.年份 === currentYear && row.月份 === currentMonth);\r\n    if (currentIndex === -1) return [];\r\n\r\n    // 获取前N个月的数据（包含当前月）\r\n    const startIndex = Math.max(0, currentIndex - timeRange + 1);\r\n    return data.slice(startIndex, currentIndex + 1);\r\n  };\r\n\r\n  const chartData = getTimeRangeData().map(row => ({\r\n    month: `${row.年份 + 2000}年${row.月份}月`,\r\n    活跃用户: row.月活,\r\n    营收: row.营收,\r\n    ARPU: row.ARPU,\r\n    使用率: row.使用率\r\n  }));\r\n\r\n  // 自定义Tooltip\r\n  const CustomTooltip = ({ active, payload, label }) => {\r\n    if (active && payload && payload.length) {\r\n      return (\r\n        <div className=\"custom-tooltip\">\r\n          <p className=\"tooltip-label\">{label}</p>\r\n          {payload.map((entry, index) => (\r\n            <p key={index} style={{ color: entry.color }}>\r\n              {entry.dataKey}: {\r\n                entry.dataKey === '活跃用户' || entry.dataKey === '营收' \r\n                  ? entry.value.toLocaleString()\r\n                  : entry.dataKey === '使用率'\r\n                  ? `${entry.value}%`\r\n                  : entry.value.toFixed(2)\r\n              }\r\n            </p>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  // 格式化Y轴数值\r\n  const formatYAxis = (value, type) => {\r\n    if (type === 'user' || type === 'revenue') {\r\n      if (value >= 10000) {\r\n        return `${(value / 10000).toFixed(0)}万`;\r\n      }\r\n      return value.toLocaleString();\r\n    }\r\n    if (type === 'usage') {\r\n      return `${value}%`;\r\n    }\r\n    return value;\r\n  };\r\n\r\n  const ChartCard = ({ title, dataKey, color, type }) => (\r\n    <div className=\"chart-card\">\r\n      <h3 className=\"chart-title\">{title}</h3>\r\n      <div className=\"chart-container\">\r\n        <ResponsiveContainer width=\"100%\" height={300}>\r\n          <LineChart data={chartData}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#f0f0f0\" />\r\n            <XAxis \r\n              dataKey=\"month\" \r\n              tick={{ fontSize: 12 }}\r\n              angle={-45}\r\n              textAnchor=\"end\"\r\n              height={60}\r\n            />\r\n            <YAxis \r\n              tick={{ fontSize: 12 }}\r\n              tickFormatter={(value) => formatYAxis(value, type)}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            <Line \r\n              type=\"monotone\" \r\n              dataKey={dataKey} \r\n              stroke={color}\r\n              strokeWidth={3}\r\n              dot={{ fill: color, strokeWidth: 2, r: 4 }}\r\n              activeDot={{ r: 6, stroke: color, strokeWidth: 2 }}\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"trend-charts\">\r\n      <div className=\"charts-header\">\r\n        <h2 className=\"section-title\">趋势分析</h2>\r\n        <div className=\"time-range-selector\">\r\n          <button \r\n            className={timeRange === 3 ? 'active' : ''}\r\n            onClick={() => setTimeRange(3)}\r\n          >\r\n            近3个月\r\n          </button>\r\n          <button \r\n            className={timeRange === 6 ? 'active' : ''}\r\n            onClick={() => setTimeRange(6)}\r\n          >\r\n            近6个月\r\n          </button>\r\n          <button \r\n            className={timeRange === 12 ? 'active' : ''}\r\n            onClick={() => setTimeRange(12)}\r\n          >\r\n            近12个月\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"charts-grid\">\r\n        <ChartCard \r\n          title=\"活跃用户趋势\" \r\n          dataKey=\"活跃用户\" \r\n          color=\"#FF6B35\" \r\n          type=\"user\"\r\n        />\r\n        <ChartCard \r\n          title=\"营收趋势\" \r\n          dataKey=\"营收\" \r\n          color=\"#FFA366\" \r\n          type=\"revenue\"\r\n        />\r\n        <ChartCard \r\n          title=\"ARPU趋势\" \r\n          dataKey=\"ARPU\" \r\n          color=\"#FF8C42\" \r\n          type=\"arpu\"\r\n        />\r\n        <ChartCard \r\n          title=\"使用率趋势\" \r\n          dataKey=\"使用率\" \r\n          color=\"#FFB366\" \r\n          type=\"usage\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TrendCharts;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}