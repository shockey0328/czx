{"ast":null,"code":"import axios from'axios';// 测试DeepSeek API连接\nexport const testDeepSeekAPI=async apiKey=>{var _data$error;try{console.log('🧪 测试DeepSeek API连接...');const response=await axios.post('https://api.deepseek.com/v1/chat/completions',{model:'deepseek-chat',messages:[{role:'user',content:'请简单回复\"API连接成功\"'}],temperature:0.1,max_tokens:50},{headers:{'Authorization':\"Bearer \".concat(apiKey),'Content-Type':'application/json'},timeout:10000// 10秒超时\n});console.log('✅ API测试成功:',response.data);return{success:true,message:'API连接成功',response:response.data.choices[0].message.content};}catch(error){console.error('❌ API测试失败:',error);let errorMessage='API连接失败';if(error.response){// 服务器返回错误\nconst status=error.response.status;const data=error.response.data;switch(status){case 401:errorMessage='API密钥无效或已过期';break;case 403:errorMessage='API密钥权限不足';break;case 429:errorMessage='API调用频率超限，请稍后重试';break;case 500:errorMessage='DeepSeek服务器内部错误';break;default:errorMessage=\"API\\u9519\\u8BEF (\".concat(status,\"): \").concat((data===null||data===void 0?void 0:(_data$error=data.error)===null||_data$error===void 0?void 0:_data$error.message)||'未知错误');}}else if(error.request){// 网络错误\nerrorMessage='网络连接失败，请检查网络设置';}else{// 其他错误\nerrorMessage=error.message||'未知错误';}return{success:false,message:errorMessage,error:error};}};// 测试数据分析功能\nexport const testDataAnalysis=async(apiKey,sampleData)=>{try{console.log('🧪 测试数据分析功能...');const prompt=\"\\n\\u8BF7\\u5206\\u6790\\u4EE5\\u4E0B\\u6570\\u636E\\u5E76\\u8FD4\\u56DEJSON\\u683C\\u5F0F\\uFF1A\\n\\u6708\\u6D3B\\u7528\\u6237\\uFF1A\".concat(sampleData.月活,\"\\n\\u8425\\u6536\\uFF1A\").concat(sampleData.营收,\"\\n\\u7559\\u5B58\\u7387\\uFF1A\").concat(sampleData.次月留存,\"%\\n\\n\\u8BF7\\u4E25\\u683C\\u6309\\u7167\\u4EE5\\u4E0BJSON\\u683C\\u5F0F\\u8FD4\\u56DE\\uFF1A\\n{\\n  \\\"keyChanges\\\": \\\"\\u5173\\u952E\\u53D8\\u5316\\u63CF\\u8FF0\\\",\\n  \\\"trends\\\": \\\"\\u8D8B\\u52BF\\u5206\\u6790\\\", \\n  \\\"suggestions\\\": [\\\"\\u5EFA\\u8BAE1\\\", \\\"\\u5EFA\\u8BAE2\\\", \\\"\\u5EFA\\u8BAE3\\\"]\\n}\\n\");const response=await axios.post('https://api.deepseek.com/v1/chat/completions',{model:'deepseek-chat',messages:[{role:'user',content:prompt}],temperature:0.7,max_tokens:300},{headers:{'Authorization':\"Bearer \".concat(apiKey),'Content-Type':'application/json'},timeout:15000});const aiResponse=response.data.choices[0].message.content;console.log('🤖 AI原始响应:',aiResponse);// 尝试解析JSON\ntry{const parsedResponse=JSON.parse(aiResponse);console.log('✅ JSON解析成功:',parsedResponse);return{success:true,message:'数据分析功能正常',data:parsedResponse};}catch(parseError){console.warn('⚠️ JSON解析失败，但API调用成功');return{success:true,message:'API调用成功，但响应格式需要调整',rawResponse:aiResponse,parseError:parseError.message};}}catch(error){console.error('❌ 数据分析测试失败:',error);return{success:false,message:'数据分析功能测试失败',error:error};}};","map":{"version":3,"names":["axios","testDeepSeekAPI","apiKey","_data$error","console","log","response","post","model","messages","role","content","temperature","max_tokens","headers","concat","timeout","data","success","message","choices","error","errorMessage","status","request","testDataAnalysis","sampleData","prompt","月活","营收","次月留存","aiResponse","parsedResponse","JSON","parse","parseError","warn","rawResponse"],"sources":["E:/橙子学数据看板/月数据看板/src/utils/testAPI.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// 测试DeepSeek API连接\r\nexport const testDeepSeekAPI = async (apiKey) => {\r\n  try {\r\n    console.log('🧪 测试DeepSeek API连接...');\r\n    \r\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\r\n      model: 'deepseek-chat',\r\n      messages: [\r\n        {\r\n          role: 'user',\r\n          content: '请简单回复\"API连接成功\"'\r\n        }\r\n      ],\r\n      temperature: 0.1,\r\n      max_tokens: 50\r\n    }, {\r\n      headers: {\r\n        'Authorization': `Bearer ${apiKey}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      timeout: 10000 // 10秒超时\r\n    });\r\n\r\n    console.log('✅ API测试成功:', response.data);\r\n    return {\r\n      success: true,\r\n      message: 'API连接成功',\r\n      response: response.data.choices[0].message.content\r\n    };\r\n  } catch (error) {\r\n    console.error('❌ API测试失败:', error);\r\n    \r\n    let errorMessage = 'API连接失败';\r\n    \r\n    if (error.response) {\r\n      // 服务器返回错误\r\n      const status = error.response.status;\r\n      const data = error.response.data;\r\n      \r\n      switch (status) {\r\n        case 401:\r\n          errorMessage = 'API密钥无效或已过期';\r\n          break;\r\n        case 403:\r\n          errorMessage = 'API密钥权限不足';\r\n          break;\r\n        case 429:\r\n          errorMessage = 'API调用频率超限，请稍后重试';\r\n          break;\r\n        case 500:\r\n          errorMessage = 'DeepSeek服务器内部错误';\r\n          break;\r\n        default:\r\n          errorMessage = `API错误 (${status}): ${data?.error?.message || '未知错误'}`;\r\n      }\r\n    } else if (error.request) {\r\n      // 网络错误\r\n      errorMessage = '网络连接失败，请检查网络设置';\r\n    } else {\r\n      // 其他错误\r\n      errorMessage = error.message || '未知错误';\r\n    }\r\n    \r\n    return {\r\n      success: false,\r\n      message: errorMessage,\r\n      error: error\r\n    };\r\n  }\r\n};\r\n\r\n// 测试数据分析功能\r\nexport const testDataAnalysis = async (apiKey, sampleData) => {\r\n  try {\r\n    console.log('🧪 测试数据分析功能...');\r\n    \r\n    const prompt = `\r\n请分析以下数据并返回JSON格式：\r\n月活用户：${sampleData.月活}\r\n营收：${sampleData.营收}\r\n留存率：${sampleData.次月留存}%\r\n\r\n请严格按照以下JSON格式返回：\r\n{\r\n  \"keyChanges\": \"关键变化描述\",\r\n  \"trends\": \"趋势分析\", \r\n  \"suggestions\": [\"建议1\", \"建议2\", \"建议3\"]\r\n}\r\n`;\r\n\r\n    const response = await axios.post('https://api.deepseek.com/v1/chat/completions', {\r\n      model: 'deepseek-chat',\r\n      messages: [\r\n        {\r\n          role: 'user',\r\n          content: prompt\r\n        }\r\n      ],\r\n      temperature: 0.7,\r\n      max_tokens: 300\r\n    }, {\r\n      headers: {\r\n        'Authorization': `Bearer ${apiKey}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      timeout: 15000\r\n    });\r\n\r\n    const aiResponse = response.data.choices[0].message.content;\r\n    console.log('🤖 AI原始响应:', aiResponse);\r\n    \r\n    // 尝试解析JSON\r\n    try {\r\n      const parsedResponse = JSON.parse(aiResponse);\r\n      console.log('✅ JSON解析成功:', parsedResponse);\r\n      \r\n      return {\r\n        success: true,\r\n        message: '数据分析功能正常',\r\n        data: parsedResponse\r\n      };\r\n    } catch (parseError) {\r\n      console.warn('⚠️ JSON解析失败，但API调用成功');\r\n      return {\r\n        success: true,\r\n        message: 'API调用成功，但响应格式需要调整',\r\n        rawResponse: aiResponse,\r\n        parseError: parseError.message\r\n      };\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('❌ 数据分析测试失败:', error);\r\n    return {\r\n      success: false,\r\n      message: '数据分析功能测试失败',\r\n      error: error\r\n    };\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}