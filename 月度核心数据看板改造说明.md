# 月度核心数据看板改造说明

## 改造目标

将月度核心数据看板从React应用改为静态HTML版本，实现完全离线使用，无需Node.js环境。

## 改造内容

### 1. 创建静态HTML版本

**文件**：`核心数据看板（月度）/index-static.html`

**特点**：
- 纯HTML/CSS/JavaScript实现
- 使用Chart.js进行数据可视化
- 支持月份选择和数据切换
- 完全离线可用

### 2. 数据加载方式

**原React版本**：
- 需要运行 `npm start`
- 通过React组件加载CSV
- 需要Node.js环境

**新静态版本**：
- 直接加载data.js文件
- 数据嵌入到页面中
- 无需任何服务器

### 3. 数据转换流程

```bash
CSV文件 → convert_csv_to_js_v2.ps1 → data.js → 静态HTML加载
```

**CSV文件位置**：
- `核心数据看板（月度）/public/月度核心数据.csv`
- `核心数据看板（月度）/public/B端核心数据.csv`

**生成的data.js**：
- `核心数据看板（月度）/public/data.js`（原始）
- `核心数据看板（月度）/data.js`（复制到主目录）

### 4. 更新统一看板配置

**修改文件**：`main.js`

**修改内容**：
```javascript
// 原配置
'core-monthly': {
    name: '核心数据',
    path: 'http://localhost:3000',
    type: 'react'
}

// 新配置
'core-monthly': {
    name: '核心数据',
    path: '核心数据看板（月度）/index-static.html',
    type: 'static'
}
```

## 功能对比

| 功能 | React版本 | 静态HTML版本 |
|------|----------|-------------|
| 运行环境 | 需要Node.js | 无需任何环境 |
| 启动方式 | npm start | 双击HTML |
| 数据加载 | 动态fetch | 嵌入data.js |
| 离线使用 | 否 | 是 |
| 月份选择 | ✓ | ✓ |
| 数据可视化 | ✓ | ✓ |
| 响应式设计 | ✓ | ✓ |

## 数据结构

### CSV格式
```csv
年份,月份,月活,次月留存,营收,订单,ARPU,ARPPU,深度访问率,使用率,大会员活跃率
25年,1月,288582,43%,569695,6538,1.97,88.1,83%,63%,80%
```

### 转换后的JavaScript格式
```javascript
dashboardData = {
    "月度核心数据": [
        {
            "年份": "25年",
            "月份": "1月",
            "月活": "288582",
            "次月留存": "43%",
            "营收": "569695",
            // ...
        }
    ]
}
```

### 页面使用的格式
```javascript
monthlyData = [
    {
        年份: "25年",
        月份: "1月",
        月活: 288582,
        次月留存: 43,  // 去除百分号
        营收: 569695,
        // ...
    }
]
```

## 使用步骤

### 1. 更新数据
```bash
更新数据.bat
```
这会自动：
- 转换CSV文件
- 生成data.js
- 复制到主目录

### 2. 测试验证
```bash
测试月度核心数据看板.html
```
或
```bash
完整测试-v2.bat
```

### 3. 使用看板

**方式1：通过统一入口**
1. 打开 `index.html`
2. 切换到"月度"
3. 选择"核心数据"

**方式2：直接打开**
```bash
核心数据看板（月度）/index-static.html
```

## 图表功能

### 1. 核心指标卡片
- 月活用户
- 次月留存率
- 营收
- ARPU
- 使用率
- 大会员活跃率

每个指标显示：
- 当前值
- 环比变化

### 2. 趋势图表
- **月活趋势**：折线图
- **营收趋势**：柱状图
- **留存率趋势**：折线图
- **ARPU趋势**：双折线图（ARPU + ARPPU）

### 3. 交互功能
- 月份选择器：切换不同月份
- 图表悬停：显示详细数据
- 响应式布局：适配不同屏幕

## 测试清单

- [ ] 运行 `更新数据.bat`
- [ ] 检查 `核心数据看板（月度）/data.js` 存在
- [ ] 打开 `测试月度核心数据看板.html`
- [ ] 测试data.js加载
- [ ] 测试数据结构（13条月度记录）
- [ ] 打开静态HTML版本
- [ ] 测试月份选择器
- [ ] 测试所有图表显示
- [ ] 测试环比数据计算
- [ ] 在统一看板中测试

## 常见问题

### Q1: 月度核心数据看板显示空白？
**检查**：
1. data.js文件是否存在
2. 浏览器控制台是否有错误
3. 运行测试页面验证数据

### Q2: 数据更新后看板没变化？
**解决**：强制刷新浏览器（Ctrl+F5）

### Q3: 图表显示异常？
**检查**：
1. Chart.js是否加载成功
2. 数据格式是否正确（百分号已去除）
3. 浏览器控制台错误信息

### Q4: 还能使用React版本吗？
**回答**：可以，React版本仍然保留在 `核心数据看板（月度）/` 目录中，运行 `npm start` 即可使用。但推荐使用静态HTML版本，更简单方便。

## 优势

### 1. 简化部署
- 无需安装Node.js
- 无需运行npm命令
- 无需等待服务器启动

### 2. 完全离线
- 所有资源本地化
- 无需网络连接
- 数据安全可控

### 3. 统一体验
- 与其他看板一致
- 统一的数据更新流程
- 统一的测试工具

### 4. 易于维护
- 代码简单清晰
- 无需管理依赖
- 更新数据方便

## 相关文件

- `核心数据看板（月度）/index-static.html` - 静态HTML版本
- `核心数据看板（月度）/data.js` - 数据文件
- `核心数据看板（月度）/public/月度核心数据.csv` - 原始CSV
- `测试月度核心数据看板.html` - 测试工具
- `更新数据.bat` - 数据更新脚本
- `main.js` - 统一看板配置

## 总结

月度核心数据看板已成功改造为静态HTML版本，实现了：
- ✅ 完全离线使用
- ✅ 无需Node.js环境
- ✅ 与其他看板统一
- ✅ 简化部署和维护
- ✅ 保留所有功能

现在所有四个看板都是静态HTML，可以完全离线使用！
