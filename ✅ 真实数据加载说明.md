# ✅ 搜索数据看板 - 真实数据加载说明

## 🎯 重要变更

搜索数据看板现在**仅使用真实的 CSV 数据**，不再有任何示例数据。

---

## ✨ 当前行为

### 数据加载成功时

**控制台输出**：
```
尝试加载第1周搜索词，状态: 200
✓ 第1周搜索词加载成功，共 100 条数据
尝试加载第2周搜索词，状态: 200
✓ 第2周搜索词加载成功，共 95 条数据
...
尝试加载搜索行为漏斗，状态: 200
✓ 搜索行为漏斗加载成功，共 8 条数据
尝试加载搜索转化率，状态: 200
✓ 搜索转化率加载成功，共 56 条数据
尝试加载搜索功能留存，状态: 200
✓ 搜索功能留存加载成功，共 8 条数据
========================================
✓ 所有数据加载成功
✓ 全部使用真实 CSV 数据
========================================
```

**页面显示**：
- 所有图表正常显示
- 数据与 CSV 文件完全一致
- 没有任何警告提示

### 数据加载失败时

**控制台输出**：
```
尝试加载第1周搜索词，状态: 404
✗ 第1周搜索词加载失败: HTTP 404 - 文件不存在或无法访问
...
========================================
✗ 数据加载失败
失败的文件:
  - 第1周搜索词: HTTP 404 - 文件不存在或无法访问
  - 搜索行为漏斗: HTTP 404 - 文件不存在或无法访问
========================================
请检查:
1. 是否通过 HTTP 服务器访问（不能直接打开 HTML 文件）
2. CSV 文件是否存在于正确的目录
3. 文件编码是否为 UTF-8
4. 文件格式是否正确（有 header，数据完整）
========================================
```

**页面显示**：
- 顶部显示红色错误提示条
- 列出所有加载失败的文件
- 提供检查建议
- 图表可能显示空白或"暂无数据"

---

## 🔍 如何验证数据准确性

### 步骤1: 启动本地服务器

**必须通过 HTTP 服务器访问！**

```bash
# 方法1: Python
python -m http.server 8000

# 方法2: 双击脚本
启动本地服务器.bat
```

### 步骤2: 访问诊断工具

```
http://localhost:8000/搜索数据看板（周度）/诊断工具.html
```

1. 点击"开始检测"- 检查所有 CSV 文件是否存在
2. 点击"测试数据加载"- 测试数据是否能正常加载
3. 查看"数据预览"- 确认数据内容正确
4. 查看"诊断总结"- 确认所有检测通过

### 步骤3: 访问主页面

```
http://localhost:8000
```

1. 按 F12 打开开发者工具
2. 切换到 Console 标签
3. 选择"周度" → "搜索数据"
4. 查看控制台输出

### 步骤4: 确认成功标志

✅ **成功的标志**：
- 控制台显示"✓ 所有数据加载成功"
- 控制台显示"✓ 全部使用真实 CSV 数据"
- 没有红色错误提示条
- 所有图表正常显示
- 数据与 CSV 文件一致

❌ **失败的标志**：
- 控制台显示"✗ 数据加载失败"
- 页面顶部有红色错误提示
- 图表显示空白或"暂无数据"
- 控制台列出失败的文件

---

## 📋 必需的 CSV 文件

确保以下文件存在于 `搜索数据看板（周度）/` 目录：

```
✓ 第1周搜索词.csv
✓ 第2周搜索词.csv
✓ 第3周搜索词.csv
✓ 第4周搜索词.csv
✓ 第5周搜索词.csv
✓ 第6周搜索词.csv
✓ 第7周搜索词.csv
✓ 第8周搜索词.csv
✓ 搜索行为漏斗.csv
✓ 搜索转化率.csv
✓ 搜索功能留存看板.csv
```

### 检查文件是否存在

```bash
# Windows
dir "搜索数据看板（周度）\*.csv"

# 应该看到 11 个文件
```

---

## 🛠️ 故障排除

### 问题1: 显示"数据加载失败"

**原因**：
- 没有通过 HTTP 服务器访问
- CSV 文件不存在
- 文件路径不正确

**解决方案**：

1. **确保通过 HTTP 服务器访问**
   ```bash
   # 启动服务器
   python -m http.server 8000
   
   # 访问（正确）
   http://localhost:8000
   
   # 不要这样（错误）
   file:///E:/橙子学数据看板/index.html
   ```

2. **检查文件是否存在**
   ```bash
   dir "搜索数据看板（周度）\*.csv"
   ```

3. **使用诊断工具**
   ```
   http://localhost:8000/搜索数据看板（周度）/诊断工具.html
   ```

### 问题2: 部分数据加载成功，部分失败

**原因**：
- 某些 CSV 文件缺失或损坏
- 文件编码不正确
- 文件格式有问题

**解决方案**：

1. **查看控制台日志**
   - 找到标记为"✗"的文件
   - 查看具体错误信息

2. **检查失败的文件**
   ```bash
   # 检查文件是否存在
   dir "搜索数据看板（周度）\失败的文件名.csv"
   
   # 查看文件内容
   type "搜索数据看板（周度）\失败的文件名.csv"
   ```

3. **验证文件格式**
   - 第一行必须是列名（header）
   - 使用逗号分隔
   - 编码为 UTF-8
   - 没有多余的空行

### 问题3: 数据不更新

**原因**：
- 浏览器缓存
- 文件没有保存

**解决方案**：

1. **强制刷新**
   ```
   Ctrl + Shift + R (Windows)
   Cmd + Shift + R (Mac)
   ```

2. **清除缓存**
   ```
   F12 → Network 标签 → 勾选 "Disable cache"
   ```

3. **确认文件已保存**
   ```bash
   # 查看文件修改时间
   dir "搜索数据看板（周度）\*.csv"
   ```

---

## 📊 CSV 文件格式要求

### 搜索词文件（第X周搜索词.csv）
```csv
keywords,pv,uv
期末,3667,320
数学,1701,221
英语,1437,229
```

**要求**：
- 必须有 header：`keywords,pv,uv`
- 至少有一行数据
- 使用逗号分隔
- UTF-8 编码

### 漏斗文件（搜索行为漏斗.csv）
```csv
week_key,date_range,search_pv,click_pv,click_rate_pv_pct,any_usage_pv,usage_rate_vs_click_pv_pct
W01,01-01 ~ 01-07,604115,418525,69.28,68676,11.37
W02,01-08 ~ 01-14,714381,484154,67.77,82229,11.51
```

**要求**：
- 必须有完整的 header
- week_key 格式：W01, W02, ...
- 数值字段不能为空

### 转化率文件（搜索转化率.csv）
```csv
dt,搜索转化率
2026-01-01,18.5
2026-01-02,19.2
```

**要求**：
- 日期格式：YYYY-MM-DD
- 转化率为数值

### 留存文件（搜索功能留存看板.csv）
```csv
cohort_week,week_0,week_1,week_2,...
2026-01-01,100,25.3,18.7,...
```

**要求**：
- week_0 始终为 100
- 其他周的留存率为数值

---

## ✅ 部署前检查清单

在推送到 GitHub 和部署到 Vercel 前，确认：

- [ ] 本地通过 HTTP 服务器测试通过
- [ ] 诊断工具显示"✓ 诊断通过"
- [ ] 控制台显示"✓ 所有数据加载成功"
- [ ] 控制台显示"✓ 全部使用真实 CSV 数据"
- [ ] 没有红色错误提示
- [ ] 所有图表正常显示
- [ ] 数据与 CSV 文件一致
- [ ] 所有 11 个 CSV 文件都存在
- [ ] 文件编码为 UTF-8
- [ ] 文件格式正确

---

## 🚀 部署到生产环境

### 本地验证通过后

1. **提交更改**
   ```bash
   git add .
   git commit -m "更新搜索数据"
   git push
   ```

2. **Vercel 自动部署**
   - 等待约 30 秒
   - 访问 Vercel 网址

3. **在线验证**
   - 按 F12 打开控制台
   - 切换到搜索数据看板
   - 确认显示"✓ 全部使用真实 CSV 数据"

---

## 📞 需要帮助？

如果遇到问题：

1. **运行诊断工具**
   ```
   http://localhost:8000/搜索数据看板（周度）/诊断工具.html
   ```

2. **查看控制台日志**
   - 按 F12
   - Console 标签
   - 截图所有日志

3. **检查文件**
   ```bash
   # 列出所有 CSV 文件
   dir "搜索数据看板（周度）\*.csv" /b
   
   # 查看文件内容
   type "搜索数据看板（周度）\第1周搜索词.csv"
   ```

---

## 🎉 总结

现在搜索数据看板：

✅ **仅使用真实 CSV 数据**  
✅ **不再有任何示例数据**  
✅ **加载失败时显示明确错误**  
✅ **提供详细的调试信息**  
✅ **包含诊断工具帮助排查**  

**确保数据100%准确！** 🎯
