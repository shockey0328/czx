# 橙子学数据看板 - 离线版使用说明

## 快速开始

1. **直接打开看板**
   - 双击 `index.html` 文件即可打开统一数据看板
   - 无需安装任何软件，无需启动服务器
   - 所有数据已嵌入，可完全离线使用

2. **切换不同看板**
   - 顶部可以切换"周度"和"月度"
   - 下拉菜单可以选择不同类型的看板：
     - 周度：核心数据、搜索数据
     - 月度：核心数据（需要单独运行）、各模块渗透率

## 更新数据

当CSV数据文件更新后，需要重新转换为JavaScript格式：

### 方法一：使用批处理脚本（推荐）

1. 双击运行 `更新数据.bat`
2. 等待转换完成
3. 刷新浏览器页面（按F5或Ctrl+F5）

### 方法二：手动转换

如果批处理脚本无法运行，可以手动执行PowerShell命令：

```powershell
# 转换搜索数据
powershell -ExecutionPolicy Bypass -File "convert_csv_to_js.ps1" -FolderPath "搜索数据看板（周度）"

# 转换核心数据
powershell -ExecutionPolicy Bypass -File "convert_csv_to_js.ps1" -FolderPath "核心数据看板（周度）"

# 转换渗透率数据
powershell -ExecutionPolicy Bypass -File "convert_csv_to_js.ps1" -FolderPath "各模块渗透率看板（月度）"
```

## 数据文件说明

### 搜索数据看板（周度）
需要以下CSV文件：
- `第1周搜索词.csv` ~ `第8周搜索词.csv`
- `搜索行为漏斗.csv`
- `搜索转化率.csv`
- `搜索功能留存看板.csv`

### 核心数据看板（周度）
需要以下CSV文件：
- `周度核心数据_utf8.csv`
- `B端核心数据_utf8.csv`
- `活跃用户趋势_utf8.csv`
- `付费用户及营收趋势_utf8.csv`
- `使用率趋势_utf8.csv`

### 各模块渗透率看板（月度）
需要以下CSV文件：
- `各模块渗透率.csv`

## 工作原理

1. **CSV转JavaScript**：`convert_csv_to_js.ps1` 脚本会读取CSV文件，转换为JavaScript对象，并保存为 `data.js`

2. **数据嵌入**：每个看板的HTML文件会加载对应的 `data.js` 文件，数据直接嵌入到页面中

3. **离线访问**：由于数据已嵌入，无需HTTP服务器，可以直接用浏览器打开HTML文件

## 常见问题

### Q: 为什么要转换CSV为JavaScript？
A: 浏览器的安全策略不允许直接从本地文件系统读取CSV文件（CORS限制）。转换为JavaScript后，数据可以直接嵌入到页面中，实现完全离线访问。

### Q: 更新数据后看板没有变化？
A: 请使用强制刷新（Ctrl+F5）清除浏览器缓存。

### Q: 批处理脚本报错怎么办？
A: 可以尝试：
1. 右键点击 `更新数据.bat`，选择"以管理员身份运行"
2. 或者使用方法二手动执行PowerShell命令

### Q: 月度核心数据看板无法显示？
A: 月度核心数据看板是React应用，需要单独运行：
```bash
cd 核心数据看板（月度）
npm install  # 首次运行
npm start
```

## 文件结构

```
橙子学数据看板/
├── index.html                      # 统一入口
├── main.js                         # 看板切换逻辑
├── styles.css                      # 样式文件
├── 更新数据.bat                    # 数据更新脚本
├── convert_csv_to_js.ps1           # CSV转换工具
├── 搜索数据看板（周度）/
│   ├── index.html
│   ├── app.js
│   ├── data.js                     # 自动生成
│   └── *.csv                       # 原始数据
├── 核心数据看板（周度）/
│   ├── index.html
│   ├── data.js                     # 自动生成
│   └── *.csv                       # 原始数据
└── 各模块渗透率看板（月度）/
    ├── index.html
    ├── script.js
    ├── data.js                     # 自动生成
    └── 各模块渗透率.csv            # 原始数据
```

## 技术支持

如有问题，请检查：
1. CSV文件是否存在且格式正确
2. 是否成功生成了 `data.js` 文件
3. 浏览器控制台是否有错误信息（按F12打开）
