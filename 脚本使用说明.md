# 脚本使用说明

## 可用脚本

### 1. 诊断并修复.bat（推荐）
**功能最全面的诊断和修复工具**

**功能：**
- ✅ 自动检查Python和Node.js环境
- ✅ 检查端口占用并自动释放
- ✅ 检查文件完整性
- ✅ 自动选择最佳服务器启动
- ✅ 自动打开测试页面

**使用方法：**
```
双击运行: 诊断并修复.bat
```

**适用场景：**
- 首次使用
- 遇到问题需要诊断
- 不确定环境是否正确配置

---

### 2. 诊断并修复.ps1
**PowerShell版本，功能更强大**

**额外功能：**
- 彩色输出，更易读
- 更详细的错误信息
- 可以交互式选择是否结束占用进程
- CSV文件编码检查

**使用方法：**
```powershell
# 右键点击文件 -> 使用PowerShell运行
# 或在PowerShell中执行：
.\诊断并修复.ps1
```

**注意：** 如果提示"无法加载，因为在此系统上禁止运行脚本"，请以管理员身份运行PowerShell并执行：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

### 3. 一键测试.bat
**最简单快速的测试工具**

**功能：**
- 快速启动服务器
- 自动打开测试页面
- 无需等待，立即测试

**使用方法：**
```
双击运行: 一键测试.bat
```

**适用场景：**
- 快速测试数据加载
- 验证修复是否成功
- 日常使用

---

### 4. 启动看板.bat
**标准启动脚本**

**功能：**
- 启动主看板服务器
- 启动React应用（月度核心数据）
- 打开主看板页面

**使用方法：**
```
双击运行: 启动看板.bat
```

**适用场景：**
- 正常使用数据看板
- 需要查看所有看板
- 生产环境使用

---

## 推荐使用流程

### 首次使用
1. 运行 `诊断并修复.bat`
2. 查看诊断结果
3. 如果测试页面显示全部✅，说明环境正常
4. 之后可以使用 `启动看板.bat` 正常使用

### 遇到问题时
1. 运行 `诊断并修复.bat` 或 `诊断并修复.ps1`
2. 查看详细的诊断信息
3. 根据提示解决问题
4. 使用 `一键测试.bat` 验证修复

### 日常使用
1. 运行 `启动看板.bat`
2. 浏览器自动打开主看板
3. 开始使用

---

## 测试页面说明

### 测试搜索看板.html
访问地址：`http://localhost:8000/测试搜索看板.html`

**功能：**
- 测试HTTP服务器状态
- 测试CSV文件访问
- 测试看板页面加载
- 提供直接访问链接

**测试结果：**
- ✅ 绿色：测试通过
- ❌ 红色：测试失败
- ℹ️ 蓝色：提示信息

### test-data-load.html
访问地址：`http://localhost:8000/搜索数据看板（周度）/test-data-load.html`

**功能：**
- 直接测试CSV文件加载
- 显示数据行数和表头
- 显示前5行数据预览

---

## 常见问题

### Q1: 脚本运行后没有反应
**解决方法：**
- 检查是否安装了Python或Node.js
- 以管理员身份运行脚本
- 查看是否有杀毒软件拦截

### Q2: 端口8000被占用
**解决方法：**
- 运行 `诊断并修复.bat`，脚本会自动释放端口
- 或手动结束占用进程：
  ```
  netstat -ano | findstr :8000
  taskkill /PID <进程ID> /F
  ```

### Q3: 浏览器没有自动打开
**解决方法：**
- 手动在浏览器中访问 `http://localhost:8000`
- 检查默认浏览器设置

### Q4: 测试页面显示错误
**解决方法：**
- 查看具体的错误信息
- 确认CSV文件存在
- 检查文件编码是否为UTF-8
- 运行 `诊断并修复.ps1` 查看详细诊断

---

## 技术支持

如果以上脚本都无法解决问题，请：

1. 运行 `诊断并修复.ps1`
2. 截图诊断结果
3. 访问 `http://localhost:8000/测试搜索看板.html`
4. 截图测试结果
5. 联系技术支持并提供截图

---

## 脚本对比

| 功能 | 诊断并修复.bat | 诊断并修复.ps1 | 一键测试.bat | 启动看板.bat |
|-----|--------------|--------------|------------|------------|
| 环境检查 | ✅ | ✅ | ❌ | ❌ |
| 端口检查 | ✅ | ✅ | ❌ | ❌ |
| 文件检查 | ✅ | ✅ | ❌ | ❌ |
| 编码检查 | ❌ | ✅ | ❌ | ❌ |
| 自动修复 | ✅ | ✅ | ❌ | ❌ |
| 彩色输出 | ❌ | ✅ | ❌ | ❌ |
| 快速启动 | ❌ | ❌ | ✅ | ✅ |
| React应用 | ❌ | ❌ | ❌ | ✅ |

---

**最后更新**: 2026-02-27  
**版本**: 1.0.0
